# CrecheBooks Integration Gaps & Opportunities Analysis

**Last Updated:** 2026-02-03
**Generated By:** Documentation Swarm (10 agents)
**Scope:** 40+ API controllers, 85 frontend pages, 22+ domain areas

## Executive Summary

CrecheBooks has substantial backend infrastructure (59+ API endpoints) with selective frontend coverage. Key gaps identified:

| Gap | Severity | Backend Status | Frontend Status |
|-----|----------|----------------|-----------------|
| Accounting Module | CRITICAL | 100% Complete | 0% (Missing) |
| Quote System | HIGH | 100% Complete | 0% (Missing) |
| Supplier Management | HIGH | 100% Complete | 0% (Missing) |
| Advanced Payroll | HIGH | 90% Complete | 20% (Stub) |
| SARS Notifications | MEDIUM | 70% Complete | N/A |

---

## 1. Backend Features Missing Frontend UI

### A. Accounting Module (CRITICAL GAP)

**APIs Present but No UI:**
- `ChartOfAccountController` - Chart of accounts CRUD, trial balance, summary
- `GeneralLedgerController` - GL posting, account transactions, summaries
- `CashFlowController` - Cash flow statements, trends, forecasting
- `SupplierController` - Supplier CRUD, payables management, aging reports
- `QuoteController` - Quote lifecycle (DRAFT→SENT→VIEWED→ACCEPTED→CONVERTED)
- `OnboardingController` - Accounting setup wizard, auto-detection

**Location:** `/apps/api/src/api/accounting/` (6 controllers, 6+ services)

**Missing Frontend Routes:**
- `/accounting/` - No pages exist
- `/accounting/quotes/` - No pages
- `/accounting/suppliers/` - No pages
- `/accounting/chart-of-accounts/` - No pages
- `/accounting/general-ledger/` - No pages

**Impact:** Backend accounting features fully functional but completely inaccessible to users.

### B. Quote System (Functional but Unlinked)

**Backend Status:** COMPLETE
- Quote creation, modification, lifecycle management
- Line item support with VAT calculations
- Quote-to-invoice conversion workflow
- Status tracking (DRAFT, SENT, VIEWED, ACCEPTED, DECLINED, EXPIRED, CONVERTED)

**TODO Found:** `apps/api/src/database/services/quote.service.ts:259`
```typescript
// TODO: Generate PDF and send email
// This would integrate with an email service
// For now, just update the status
```

**Missing Features:**
- Quote generation UI
- Quote recipient management
- PDF generation & email delivery
- Quote acceptance flow (for public/parent portal)
- Expiry automation

### C. Supplier Management

**Backend Status:** COMPLETE
- Supplier CRUD operations
- Payables tracking and aging
- Supplier statement generation
- Payment terms management

**Frontend Status:** MISSING
- No supplier list/create pages
- No payables aging report UI
- No supplier statement viewer

---

## 2. Frontend Screens Needing API Integration

### A. Payroll Processing (Incomplete)

**File:** `/apps/web/src/app/(dashboard)/staff/payroll/page.tsx`

**Status:** STUB IMPLEMENTATION

**TODO Found:**
```typescript
const handleComplete = async (selectedStaff: string[], payrollEntries: IPayrollEntry[]): Promise<void> => {
  // TODO: Implement actual payroll processing
  router.push('/staff');
};
```

**Missing Implementation:**
- No API call to save payroll entries
- No integration with PAYE calculation service
- No journal posting to Xero
- No payslip generation trigger
- No statutory declaration submission

### B. Settings Profile Update

**File:** `/apps/web/src/app/(dashboard)/settings/page.tsx`

**TODO Found:**
```typescript
const onSubmit = async (data: ProfileFormData) => {
  // TODO: Implement profile update API call
};
```

### C. Invoice Deletion

**File:** `/apps/web/src/app/(dashboard)/invoices/page.tsx`

**TODO Found:**
```typescript
// TODO: Confirm and delete
```

**Status:** Delete button present but no implementation logic

---

## 3. Implementation Issues & TODOs

### A. Currency Conversion Service

**File:** `/apps/api/src/database/services/currency-conversion.service.ts`

```typescript
// TODO: Implement actual SARB/OANDA API integration
```

**Issue:** Returns placeholder values instead of real FX rates.

### B. Bank Fee Configuration

**File:** `/apps/api/src/database/services/bank-fee.service.ts`

```typescript
// TODO: Add bank_fee_config column to tenant table
// TODO: Add support for other SA banks (Standard Bank, Nedbank, ABSA, Capitec)
```

**Status:** Currently hardcoded FNB-only

### C. Statement Generation Pagination

**File:** `/apps/api/src/database/services/statement-generation.service.ts`

```typescript
// TODO: Implement proper pagination for very large tenant datasets
```

**Risk:** May timeout for tenants with thousands of transactions.

### D. SARS Submission Notifications

**File:** `/apps/api/src/database/services/sars-submission-retry.service.ts`

```typescript
// TODO: Send email notification to administrators
// TODO: Create notification record in database
// TODO: Trigger webhook if configured
```

**Impact:** Failed SARS submissions are logged but users aren't notified.

### E. Transaction Reversal Database Fields

**File:** `/apps/api/src/database/services/transaction-reversal.service.ts`

```typescript
// TODO: Add 'notes' field to Categorization model
// TODO: Add 'isReversed', 'reversedAt', 'reversalReason' fields to BankStatementMatch model
```

**Status:** Logic exists but can't persist reversal context.

---

## 4. Integration Mismatches

### A. SimplePay Integration

**Concern:** `.bak` backup file exists (`simplepay.controller.ts.bak`), suggesting recent refactoring.

**Risk:** Frontend may be out of sync with current API implementation.

### B. Xero Payroll Integration

**Backend Components:** Full implementation
- `XeroPayrollJournalController` - Full CRUD, stats, pending operations
- `XeroAccountMappingService` - Account code mapping

**Frontend Components:** Exist but need verification
- `AccountMappingsTable`
- `PayrollJournalsTable`

**Action Required:** Verify components call correct API endpoints.

---

## 5. Priority Recommendations

### Phase 1: Foundation (Weeks 1-2)

| Task | Effort | Impact | Dependencies |
|------|--------|--------|--------------|
| Accounting Dashboard | 3-4 days | HIGH | Unblocks Quote/Supplier UI |
| Complete Payroll Processing | 3-4 days | HIGH | Frontend stub exists |
| SARS Notifications | 1-2 days | MEDIUM | Quick win |

### Phase 2: Features (Weeks 3-4)

| Task | Effort | Impact | Dependencies |
|------|--------|--------|--------------|
| Quote Management UI | 2-3 days | HIGH | Phase 1 Accounting |
| Supplier Portal | 2-3 days | HIGH | Phase 1 Accounting |
| Quote PDF & Email | 1-2 days | MEDIUM | Quote Management |

### Phase 3: Polish (Weeks 5+)

| Task | Effort | Impact | Dependencies |
|------|--------|--------|--------------|
| Currency Conversion | 2 days | LOW | None |
| Bank Fee Configuration | 2-3 days | MEDIUM | None |
| Statement Pagination | 2 days | LOW | None |

---

## 6. Risk Assessment Summary

| Component | Risk Level | Issue | Resolution |
|-----------|------------|-------|------------|
| Accounting Module | CRITICAL | 100% missing UI | Build frontend pages |
| Payroll Processing | HIGH | Incomplete implementation | Wire to API |
| SARS Notifications | MEDIUM | Silent failures | Add notification service |
| Transaction Reversal | MEDIUM | Missing DB fields | Add Prisma fields |
| Quote PDF Generation | LOW | TODO present | Implement PDF service |
| Currency Conversion | LOW | Placeholder API | Integrate SARB/OANDA |

---

## 7. Quick Wins Checklist

- [ ] Fix SARS submission notifications (1-2 days)
- [ ] Complete profile update implementation (1 day)
- [ ] Remove or implement invoice delete handler (1 day)
- [ ] Wire payroll `handleComplete` to API (2 days)
- [ ] Verify Xero integration component-API alignment (1 day)

---

## Conclusion

CrecheBooks has **strong backend infrastructure** with **selective frontend coverage**. The primary gap is the **entirely missing Accounting module UI** despite having complete backend support.

**Highest-impact work:**
1. Accounting Dashboard (Chart of Accounts, GL, Trial Balance)
2. Quote Management (create, send, track, convert)
3. Supplier Management (payables, aging, statements)
4. Complete Payroll Processing flow

All backend APIs are 80-100% complete. Frontend work is primarily **UI integration**, not new feature development.

---

*Generated by CrecheBooks Documentation Swarm - 10 agents analyzing 40+ controllers and 85 frontend pages*
